4253/4253 [==============================] - ETA: 0s - loss: 0.4282 - accuracy: 0.8639 - auc: 0.9743
Epoch 00001: val_loss improved from inf to 0.20722, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1601s 376ms/step - loss: 0.4282 - accuracy: 0.8639 - auc: 0.9743 - val_loss: 0.2072 - val_accuracy: 0.9436 - val_auc: 0.9947
Epoch 2/20
4253/4253 [==============================] - ETA: 0s - loss: 0.2223 - accuracy: 0.9290 - auc: 0.9919
Epoch 00002: val_loss improved from 0.20722 to 0.11568, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1601s 376ms/step - loss: 0.2223 - accuracy: 0.9290 - auc: 0.9919 - val_loss: 0.1157 - val_accuracy: 0.9662 - val_auc: 0.9975
Epoch 3/20
4253/4253 [==============================] - ETA: 0s - loss: 0.1340 - accuracy: 0.9572 - auc: 0.9963
Epoch 00003: val_loss improved from 0.11568 to 0.06590, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1600s 376ms/step - loss: 0.1340 - accuracy: 0.9572 - auc: 0.9963 - val_loss: 0.0659 - val_accuracy: 0.9828 - val_auc: 0.9992
Epoch 4/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.9676 - auc: 0.9977
Epoch 00004: val_loss improved from 0.06590 to 0.06389, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1603s 377ms/step - loss: 0.0993 - accuracy: 0.9676 - auc: 0.9977 - val_loss: 0.0639 - val_accuracy: 0.9787 - val_auc: 0.9992
Epoch 5/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0794 - accuracy: 0.9734 - auc: 0.9984
Epoch 00005: val_loss improved from 0.06389 to 0.05159, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1602s 377ms/step - loss: 0.0794 - accuracy: 0.9734 - auc: 0.9984 - val_loss: 0.0516 - val_accuracy: 0.9831 - val_auc: 0.9994
Epoch 6/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0703 - accuracy: 0.9761 - auc: 0.9987
Epoch 00006: val_loss improved from 0.05159 to 0.05121, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1600s 376ms/step - loss: 0.0703 - accuracy: 0.9761 - auc: 0.9987 - val_loss: 0.0512 - val_accuracy: 0.9838 - val_auc: 0.9991
Epoch 7/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0656 - accuracy: 0.9773 - auc: 0.9988
Epoch 00007: val_loss improved from 0.05121 to 0.04196, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1599s 376ms/step - loss: 0.0656 - accuracy: 0.9773 - auc: 0.9988 - val_loss: 0.0420 - val_accuracy: 0.9866 - val_auc: 0.9996
Epoch 8/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0597 - accuracy: 0.9794 - auc: 0.9989
Epoch 00008: val_loss did not improve from 0.04196
4253/4253 [==============================] - 1599s 376ms/step - loss: 0.0597 - accuracy: 0.9794 - auc: 0.9989 - val_loss: 0.0568 - val_accuracy: 0.9807 - val_auc: 0.9992
Epoch 9/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0577 - accuracy: 0.9805 - auc: 0.9990
Epoch 00009: val_loss did not improve from 0.04196
4253/4253 [==============================] - 1599s 376ms/step - loss: 0.0577 - accuracy: 0.9805 - auc: 0.9990 - val_loss: 0.0546 - val_accuracy: 0.9823 - val_auc: 0.9991
Epoch 10/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0529 - accuracy: 0.9822 - auc: 0.9990
Epoch 00010: val_loss improved from 0.04196 to 0.03527, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1600s 376ms/step - loss: 0.0529 - accuracy: 0.9822 - auc: 0.9990 - val_loss: 0.0353 - val_accuracy: 0.9877 - val_auc: 0.9996
Epoch 11/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0514 - accuracy: 0.9826 - auc: 0.9991
Epoch 00011: val_loss did not improve from 0.03527
4253/4253 [==============================] - 1598s 376ms/step - loss: 0.0514 - accuracy: 0.9826 - auc: 0.9991 - val_loss: 0.0489 - val_accuracy: 0.9835 - val_auc: 0.9992
Epoch 12/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0487 - accuracy: 0.9833 - auc: 0.9992
Epoch 00012: val_loss improved from 0.03527 to 0.03277, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1599s 376ms/step - loss: 0.0487 - accuracy: 0.9833 - auc: 0.9992 - val_loss: 0.0328 - val_accuracy: 0.9887 - val_auc: 0.9996
Epoch 13/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0454 - accuracy: 0.9849 - auc: 0.9991
Epoch 00013: val_loss did not improve from 0.03277
4253/4253 [==============================] - 1598s 376ms/step - loss: 0.0454 - accuracy: 0.9849 - auc: 0.9991 - val_loss: 0.0649 - val_accuracy: 0.9762 - val_auc: 0.9991
Epoch 14/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0446 - accuracy: 0.9851 - auc: 0.9992
Epoch 00014: val_loss did not improve from 0.03277
4253/4253 [==============================] - 1605s 377ms/step - loss: 0.0446 - accuracy: 0.9851 - auc: 0.9992 - val_loss: 0.0346 - val_accuracy: 0.9890 - val_auc: 0.9993
Epoch 15/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0404 - accuracy: 0.9863 - auc: 0.9994
Epoch 00015: val_loss did not improve from 0.03277
4253/4253 [==============================] - 1596s 375ms/step - loss: 0.0404 - accuracy: 0.9863 - auc: 0.9994 - val_loss: 0.0340 - val_accuracy: 0.9887 - val_auc: 0.9994
Epoch 16/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0405 - accuracy: 0.9861 - auc: 0.9993
Epoch 00016: val_loss improved from 0.03277 to 0.02948, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1597s 376ms/step - loss: 0.0405 - accuracy: 0.9861 - auc: 0.9993 - val_loss: 0.0295 - val_accuracy: 0.9906 - val_auc: 0.9995
Epoch 17/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0377 - accuracy: 0.9875 - auc: 0.9994
Epoch 00017: val_loss improved from 0.02948 to 0.02543, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1598s 376ms/step - loss: 0.0377 - accuracy: 0.9875 - auc: 0.9994 - val_loss: 0.0254 - val_accuracy: 0.9904 - val_auc: 0.9998
Epoch 18/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0375 - accuracy: 0.9876 - auc: 0.9994
Epoch 00018: val_loss did not improve from 0.02543
4253/4253 [==============================] - 1611s 379ms/step - loss: 0.0375 - accuracy: 0.9876 - auc: 0.9994 - val_loss: 0.0386 - val_accuracy: 0.9864 - val_auc: 0.9995
Epoch 19/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0354 - accuracy: 0.9887 - auc: 0.9994
Epoch 00019: val_loss improved from 0.02543 to 0.02500, saving model to /home/ubuntu/repos/hotel-rank-learning/data/models/resnet50_ResNet50_v1.h5
4253/4253 [==============================] - 1624s 382ms/step - loss: 0.0354 - accuracy: 0.9887 - auc: 0.9994 - val_loss: 0.0250 - val_accuracy: 0.9907 - val_auc: 0.9998
Epoch 20/20
4253/4253 [==============================] - ETA: 0s - loss: 0.0365 - accuracy: 0.9880 - auc: 0.9994
Epoch 00020: val_loss did not improve from 0.02500
4253/4253 [==============================] - 1623s 382ms/step - loss: 0.0365 - accuracy: 0.9880 - auc: 0.9994 - val_loss: 0.0359 - val_accuracy: 0.9877 - val_auc: 0.9995
WARNING:tensorflow:From train_images.py:99: Model.evaluate_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.evaluate, which supports generators.
Test loss: 1.234851598739624
Test accuracy: 0.7626547813415527
/home/ubuntu/repos/hotel-rank-learning/data
Accuracy: 0.762655
Weighted F1 score: 0.764507
[[2026   19    0    0    0]
 [  39 6912 1374  270   82]
 [   1  967 4325  533   84]
 [   2  333 1245 3132  289]
 [  17   97  137  569 3071]]
Total used time : 32592.66324019432 s.
